---
name: wechat
description: 微信桌面版操作技能，包含聊天、搜索联系人、发送消息、查看朋友圈等操作指导。当需要操作微信应用时使用。
---

# WeChat Desktop Skill

## 应用识别

- 应用名称：微信 / WeChat
- macOS进程名：WeChat
- Windows进程名：WeChat.exe

## 界面布局

微信桌面版主要分为三个区域：

```
┌─────────┬──────────────┬─────────────────────┐
│ 侧边栏   │   会话列表    │      聊天区域        │
│         │              │                     │
│ [聊天]   │  联系人1      │   消息历史           │
│ [通讯录] │  联系人2      │                     │
│ [收藏]   │  群聊1        │                     │
│ [朋友圈] │  ...         │   ─────────────     │
│ [设置]   │              │   [输入框]  [发送]   │
└─────────┴──────────────┴─────────────────────┘
```

## 常用操作

### 搜索联系人/群聊

1. 点击搜索框（会话列表顶部）或使用快捷键 `cmd f` (macOS) / `ctrl f` (Windows)
2. 输入联系人名称或群聊名称
3. 等待搜索结果出现
4. 点击目标联系人/群聊

```
操作序列：
click [搜索框] → type "联系人名" → wait 500 → click [搜索结果]
```

### 发送文字消息

1. 确保已选中目标聊天
2. 点击底部输入框
3. 输入消息内容
4. 按 `enter` 发送（默认设置）或点击发送按钮

```
操作序列：
click [输入框] → type "消息内容" → hotkey "enter"
```

**注意**：微信默认 `enter` 发送消息，`shift enter` 换行。如果需要发送多行消息：
```
type "第一行\n第二行\n第三行" → hotkey "enter"
```

### 发送图片/文件

1. 点击输入框左侧的文件图标
2. 选择"发送图片"或"发送文件"
3. 在文件选择器中选择文件
4. 确认发送

### 查看聊天记录

- 向上滚动查看历史消息：`scroll [聊天区域] up`
- 搜索聊天记录：点击聊天窗口右上角的 `...` → 查找聊天记录

### 切换到通讯录

1. 点击左侧边栏的"通讯录"图标
2. 在通讯录列表中查找联系人

### 查看朋友圈

1. 点击左侧边栏的"朋友圈"图标（如果有）
2. 或通过"发现"入口进入

## 快捷键

### macOS
- `cmd f` → 搜索
- `cmd n` → 新建聊天
- `cmd w` → 关闭当前窗口
- `cmd q` → 退出微信
- `cmd ,` → 打开设置
- `enter` → 发送消息
- `shift enter` → 换行

### Windows
- `ctrl f` → 搜索
- `ctrl n` → 新建聊天
- `alt f4` → 退出微信
- `enter` → 发送消息
- `shift enter` → 换行

## 常见场景

### 场景1：给某人发消息

```
1. cmd f (打开搜索)
2. type "联系人名"
3. wait 500
4. click [搜索结果中的联系人]
5. wait 300
6. click [输入框]
7. type "消息内容"
8. hotkey "enter"
```

### 场景2：持续对话直到特定条件

```
循环执行：
1. 观察最新消息
2. 如果对方回复了特定内容 → finished
3. 否则继续等待或回复
4. wait 2000 (等待新消息)
```

### 场景3：发送多条消息

```
click [输入框]
type "第一条消息" → hotkey "enter"
wait 300
type "第二条消息" → hotkey "enter"
wait 300
type "第三条消息" → hotkey "enter"
```

## 注意事项

1. **发送前确认收件人**：发送消息前必须确认当前聊天窗口顶部显示的联系人/群聊名称与目标一致。发错人后果严重，务必核实。
2. **会话列表单击切换**：左侧会话列表中的联系人/群聊只需**单击一次**即可切换到对应对话框。**不要双击**，双击会打开一个独立的聊天窗口，这是不必要的。
3. **窗口焦点**：确保微信窗口处于激活状态，否则第一次点击只会激活窗口
4. **搜索延迟**：搜索联系人后需要等待结果加载，建议 wait 500ms
5. **消息发送**：默认 enter 发送，如果用户修改了设置可能需要点击发送按钮
6. **表情符号**：可以直接在消息中使用 emoji，微信会正确显示
7. **@提及**：在群聊中 @ 某人，输入 `@` 后会弹出成员列表
8. **图片识别**：聊天区域的消息气泡，左侧是对方消息，右侧是自己消息
9. **未读消息**：会话列表中有红点或数字标记的是未读消息

## 界面元素定位提示

- **搜索框**：通常在会话列表顶部，有放大镜图标
- **输入框**：聊天区域底部，通常有"输入消息"占位文字
- **发送按钮**：输入框右侧
- **侧边栏图标**：最左侧垂直排列的图标
- **联系人头像**：圆形或圆角方形图片
- **消息气泡**：带有圆角的矩形区域
